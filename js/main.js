document.addEventListener("DOMContentLoaded",function(){let B,I,A=!1;const F=t=>{const e=o=>Array.from(o).reduce((s,i)=>s+i.offsetWidth,0);if(t){const o=e(document.querySelector("#blog-info > a").children),s=e(document.getElementById("menus").children);B=o+s,I=document.getElementById("nav")}const n=window.innerWidth<=768||B>I.offsetWidth-120;I.classList.toggle("hide-menu",n)},x=()=>{F(!0),I.classList.add("show")},G={open:()=>{btf.sidebarPaddingR(),document.body.style.overflow="hidden",btf.animateIn(document.getElementById("menu-mask"),"to_show 0.5s"),document.getElementById("sidebar-menus").classList.add("open"),A=!0},close:()=>{const t=document.body;t.style.overflow="",t.style.paddingRight="",btf.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s"),document.getElementById("sidebar-menus").classList.remove("open"),A=!1}},N=()=>{const t=()=>{btf.scrollToDest(document.getElementById("content-inner").offsetTop,300)},e=document.getElementById("scroll-down");e&&btf.addEventListenerPjax(e,"click",t)},$=()=>{const t=GLOBAL_CONFIG.highlight;if(!t)return;const{highlightCopy:e,highlightLang:n,highlightHeightLimit:o,plugin:s}=t,i=GLOBAL_CONFIG_SITE.isHighlightShrink,r=e||n||i!==void 0,u=s==="highlight.js"?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if(!((r||o)&&u.length))return;const f=s==="prismjs",h=i===!0?"closed":"",L=i!==void 0?'<i class="fas fa-angle-down expand"></i>':"",E=e?'<div class="copy-notice"></div><i class="fas fa-paste copy-button"></i>':"",m=(l,a)=>{if(GLOBAL_CONFIG.Snackbar!==void 0)btf.snackbarShow(a);else{const p=l.previousElementSibling;p.textContent=a,p.style.opacity=1,setTimeout(()=>{p.style.opacity=0},800)}},v=l=>{document.queryCommandSupported&&document.queryCommandSupported("copy")?(document.execCommand("copy"),m(l,GLOBAL_CONFIG.copy.success)):m(l,GLOBAL_CONFIG.copy.noSupport)},d=l=>{const a=l.parentNode;a.classList.add("copy-true");const p=window.getSelection(),C=document.createRange(),y=f?"pre code":"table .code pre";C.selectNodeContents(a.querySelectorAll(`${y}`)[0]),p.removeAllRanges(),p.addRange(C),v(l.lastChild),p.removeAllRanges(),a.classList.remove("copy-true")},c=l=>{l.classList.toggle("closed")},g=function(l){const a=l.target.classList;a.contains("expand")?c(this):a.contains("copy-button")&&d(this)},b=function(){this.classList.toggle("expand-done")},w=(l,a,p)=>{const C=document.createDocumentFragment();if(r){const y=document.createElement("div");y.className=`highlight-tools ${h}`,y.innerHTML=L+l+E,btf.addEventListenerPjax(y,"click",g),C.appendChild(y)}if(o&&a.offsetHeight>o+30){const y=document.createElement("div");y.className="code-expand-btn",y.innerHTML='<i class="fas fa-angle-double-down"></i>',btf.addEventListenerPjax(y,"click",b),C.appendChild(y)}p==="hl"?a.insertBefore(C,a.firstChild):a.parentNode.insertBefore(C,a)};f?u.forEach(l=>{if(n){const p=`<div class="code-lang">${l.getAttribute("data-language")||"Code"}</div>`;btf.wrap(l,"figure",{class:"highlight"}),w(p,l)}else btf.wrap(l,"figure",{class:"highlight"}),w("",l)}):u.forEach(l=>{if(n){let a=l.getAttribute("class").split(" ")[1];(a==="plain"||a===void 0)&&(a="Code");const p=`<div class="code-lang">${a}</div>`;w(p,l,"hl")}else w("",l,"hl")})},_=()=>{document.querySelectorAll("#article-container img").forEach(t=>{const e=t.title||t.alt;if(!e)return;const n=document.createElement("div");n.className="img-alt is-center",n.textContent=e,t.insertAdjacentElement("afterend",n)})},D=()=>{btf.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)"))},q=async t=>await(await fetch(t)).json(),P=(t,e,n=!1,o)=>{const s=e.length,i=new InfiniteGrid.JustifiedInfiniteGrid(t,{gap:5,isConstantSize:!0,sizeRange:[150,600],useResizeObserver:!0,observeChildren:!0,useTransform:!0});o&&btf.addGlobalFn("igOfTabs",()=>{i.destroy()},!1,o);const r=d=>d.replace(/"/g,"&quot;"),u=(d,c)=>{const g=[],b=(d-1)*c;for(let w=0;w<c;++w){const l=b+w;if(l>=s)break;const a=e[l],p=a.alt?`alt="${r(a.alt)}"`:"",C=a.title?`title="${r(a.title)}"`:"";g.push(`<div class="item ">
            <img src="${a.url}" data-grid-maintained-target="true" ${p+C} />
          </div>`)}return g},f=GLOBAL_CONFIG.infinitegrid.buttonText,h=d=>{const c=document.createElement("button");c.textContent=f;const g=b=>{b.target.removeEventListener("click",g),b.target.remove(),btf.setLoading.add(d),L(i.getGroups().length+1,10)};c.addEventListener("click",g),d.insertAdjacentElement("afterend",c)},L=(d,c)=>{i.append(u(d,c),d)},E=Math.ceil(s/10),m=d=>{const{updated:c,isResize:g,mounted:b}=d;if(!(!c.length||!b.length||g)){if(btf.loadLightbox(t.querySelectorAll("img:not(.medium-zoom-image)")),i.getGroups().length===E){btf.setLoading.remove(t),i.off("renderComplete",m);return}n&&(btf.setLoading.remove(t),h(t))}},v=btf.debounce(d=>{const c=(+d.groupKey||0)+1;L(c,10),c===E&&i.off("requestAppend",v)},300);btf.setLoading.add(t),i.on("renderComplete",m),n?L(1,10):(i.on("requestAppend",v),i.renderItems()),btf.addGlobalFn("justifiedGallery",()=>{i.destroy()})},O=async(t,e=!1)=>{const n=async()=>{for(const o of t){if(btf.isHidden(o))continue;if(e&&o.classList.contains("loaded")){o.querySelector(".gallery-items").innerHTML="";const u=o.querySelector(":scope > button"),f=o.querySelector(":scope > .loading-container");u&&u.remove(),f&&f.remove()}const s=o.getAttribute("data-button")==="true",i=o.firstElementChild.textContent;o.classList.add("loaded");const r=o.getAttribute("data-type")==="url"?await q(i):JSON.parse(i);P(o.lastElementChild,r,s,e)}};typeof InfiniteGrid=="function"||await getScript(`${GLOBAL_CONFIG.infinitegrid.js}`),n()},j=t=>{const e=btf.getScrollPercent(t,document.body),n=document.getElementById("go-up");e<95?(n.classList.add("show-percent"),n.querySelector(".scroll-percent").textContent=e):n.classList.remove("show-percent")},H=()=>{const t=document.getElementById("rightside"),e=window.innerHeight+56;let n=0;const o=document.getElementById("page-header"),s=typeof chatBtn<"u",i=GLOBAL_CONFIG.percent.rightside;if(document.body.scrollHeight<=e){t.classList.add("rightside-show");return}const r=h=>{const L=h>n;return n=h,L};let u="";const f=btf.throttle(()=>{const h=window.scrollY||document.documentElement.scrollTop,L=r(h);h>56?(u===""&&(o.classList.add("nav-fixed"),t.classList.add("rightside-show")),L?u!=="down"&&(o.classList.remove("nav-visible"),s&&window.chatBtn.hide(),u="down"):u!=="up"&&(o.classList.add("nav-visible"),s&&window.chatBtn.show(),u="up")):(u="",h===0&&o.classList.remove("nav-fixed","nav-visible"),t.classList.remove("rightside-show")),i&&j(h),document.body.scrollHeight<=e&&t.classList.add("rightside-show")},300);btf.addEventListenerPjax(window,"scroll",f,{passive:!0})},M=()=>{const t=GLOBAL_CONFIG_SITE.isToc,e=GLOBAL_CONFIG.isAnchor,n=document.getElementById("article-container");if(!(n&&(t||e)))return;let o,s,i,r,u;if(t){const m=document.getElementById("card-toc");s=m.querySelector(".toc-content"),o=s.querySelectorAll(".toc-link"),r=m.querySelector(".toc-percentage"),u=s.classList.contains("is-expand");const v=d=>{const c=d.target.closest(".toc-link");c&&(d.preventDefault(),btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI(c.getAttribute("href")).replace("#",""))),300),window.innerWidth<900&&m.classList.remove("open"))};btf.addEventListenerPjax(s,"click",v),i=d=>{const c=d.getBoundingClientRect().top,g=s.scrollTop;c>document.documentElement.clientHeight-100&&(s.scrollTop=g+150),c<100&&(s.scrollTop=g-150)}}const f=n.querySelectorAll("h1,h2,h3,h4,h5,h6");let h="";const L=m=>{if(m===0)return!1;let v="",d="";if(f.forEach((c,g)=>{if(m>btf.getEleTop(c)-80){const b=c.id;v=b?"#"+encodeURI(b):"",d=g}}),h!==d&&(e&&btf.updateAnchor(v),h=d,t)){if(s.querySelectorAll(".active").forEach(b=>{b.classList.remove("active")}),v==="")return;const c=o[d];if(c.classList.add("active"),setTimeout(()=>{i(c)},0),u)return;let g=c.parentNode;for(;!g.matches(".toc");g=g.parentNode)g.matches("li")&&g.classList.add("active")}},E=btf.throttle(()=>{const m=window.scrollY||document.documentElement.scrollTop;t&&GLOBAL_CONFIG.percent.toc&&(r.textContent=btf.getScrollPercent(m,n)),L(m)},100);btf.addEventListenerPjax(window,"scroll",E,{passive:!0})},S=t=>{const n=(window.globalFn||{}).themeChange||{};n&&Object.keys(n).forEach(o=>{const s=n[o];["disqus","disqusjs"].includes(o)?setTimeout(()=>s(t),300):s(t)})},k={readmode:()=>{const t=document.body;t.classList.add("read-mode");const e=document.createElement("button");e.type="button",e.className="fas fa-sign-out-alt exit-readmode",t.appendChild(e);const n=()=>{t.classList.remove("read-mode"),e.remove(),e.removeEventListener("click",n)};e.addEventListener("click",n)},darkmode:()=>{const t=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";t==="dark"?(activateDarkMode(),GLOBAL_CONFIG.Snackbar!==void 0&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),GLOBAL_CONFIG.Snackbar!==void 0&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),saveToLocal.set("theme",t,2),S(t)},"rightside-config":t=>{const e=t.firstElementChild;e.classList.contains("show")&&(e.classList.add("status"),setTimeout(()=>{e.classList.remove("status")},300)),e.classList.toggle("show")},"go-up":()=>{btf.scrollToDest(0,500)},"hide-aside-btn":()=>{const t=document.documentElement.classList,e=t.contains("hide-aside")?"show":"hide";saveToLocal.set("aside-status",e,2),t.toggle("hide-aside")},"mobile-toc-button":t=>{const e=document.getElementById("card-toc");e.style.transition="transform 0.3s ease-in-out",e.classList.toggle("open"),e.addEventListener("transitionend",()=>{e.style.transition=""},{once:!0})},"chat-btn":()=>{window.chatBtnFn()},translateLink:()=>{window.translateFn.translatePage()}};document.getElementById("rightside").addEventListener("click",function(t){const e=t.target.closest("[id]");e&&k[e.id]&&k[e.id](this)});const R=()=>{const t=e=>{const n=e.target.closest(".site-page.group");n&&n.classList.toggle("hide")};document.querySelector("#sidebar-menus .menus_items").addEventListener("click",t)},z=()=>{const t=()=>{G.open()};btf.addEventListenerPjax(document.getElementById("toggle-menu"),"click",t)},W=()=>{const{limitCount:t,languages:e}=GLOBAL_CONFIG.copyright,n=o=>{o.preventDefault();const s=window.getSelection(0).toString();let i=s;return s.length>t&&(i=`${s}


${e.author}
${e.link}${window.location.href}
${e.source}
${e.info}`),o.clipboardData?o.clipboardData.setData("text",i):window.clipboardData.setData("text",i)};document.body.addEventListener("copy",n)},J=()=>{const t=document.getElementById("runtimeshow");if(t){const e=t.getAttribute("data-publishDate");t.textContent=`${btf.diffDate(e)} ${GLOBAL_CONFIG.runtime}`}},U=()=>{const t=document.getElementById("last-push-date");if(t){const e=t.getAttribute("data-lastPushDate");t.textContent=btf.diffDate(e,!0)}},K=()=>{const t=document.querySelectorAll("#article-container table");t.length&&t.forEach(e=>{e.closest(".highlight")||btf.wrap(e,"div",{class:"table-wrap"})})},V=()=>{const t=document.querySelectorAll("#article-container .hide-button");if(!t.length)return;const e=function(n){const o=this;o.classList.add("open");const s=o.nextElementSibling.querySelectorAll(".gallery-container");s.length&&O(s)};t.forEach(n=>{n.addEventListener("click",e,{once:!0})})},Y=()=>{const t=document.querySelectorAll("#article-container .tabs");if(!t.length)return;const e=(s,i)=>{Array.from(s).forEach(r=>{r.classList.remove("active"),(r===i||r.id===i)&&r.classList.add("active")})},n=(s,i)=>{const r=function(u){const f=u.target.closest("button");if(f.classList.contains("active"))return;e(this.children,f),this.classList.remove("no-default");const h=f.getAttribute("data-href"),L=this.nextElementSibling;if(e(L.children,h),i){btf.removeGlobalFnEvent("igOfTabs",this);const E=L.querySelectorAll(`:scope > #${h} .gallery-container`);E.length&&O(E,this)}};btf.addEventListenerPjax(s.firstElementChild,"click",r)},o=s=>{const i=r=>{r.target.closest("button")&&btf.scrollToDest(btf.getEleTop(s),300)};btf.addEventListenerPjax(s.lastElementChild,"click",i)};t.forEach(s=>{const i=!!s.querySelectorAll(".gallery-container");n(s,i),o(s)})},Q=()=>{const t=document.querySelector("#aside-cat-list.expandBtn");if(!t)return;const e=n=>{const o=n.target;o.nodeName==="I"&&(n.preventDefault(),o.parentNode.classList.toggle("expand"))};btf.addEventListenerPjax(t,"click",e,!0)},X=()=>{const t=document.getElementById("switch-btn");if(!t)return;let e=!1;const n=document.getElementById("post-comment"),o=()=>{n.classList.toggle("move"),!e&&typeof loadOtherComment=="function"&&(e=!0,loadOtherComment())};btf.addEventListenerPjax(t,"click",o)},Z=()=>{const{limitDay:t,messagePrev:e,messageNext:n,position:o}=GLOBAL_CONFIG.noticeOutdate,s=btf.diffDate(GLOBAL_CONFIG_SITE.postUpdate);if(s>=t){const i=document.createElement("div");i.className="post-outdate-notice",i.textContent=`${e} ${s} ${n}`;const r=document.getElementById("article-container");o==="top"?r.insertBefore(i,r.firstChild):r.appendChild(i)}},tt=()=>{window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"})},T=function(t){t.forEach(e=>{const n=e.getAttribute("datetime");e.textContent=btf.diffDate(n,!0),e.style.display="inline"})},et=function(){window.addEventListener("resize",()=>{F(!1),A&&btf.isHidden(document.getElementById("toggle-menu"))&&G.close()}),document.getElementById("menu-mask").addEventListener("click",t=>{G.close()}),R(),GLOBAL_CONFIG.islazyload&&tt(),GLOBAL_CONFIG.copyright!==void 0&&W(),GLOBAL_CONFIG.autoDarkmode&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{saveToLocal.get("theme")===void 0&&(t.matches?S("dark"):S("light"))})};window.refreshFn=function(){x(),GLOBAL_CONFIG_SITE.isPost?(GLOBAL_CONFIG.noticeOutdate!==void 0&&Z(),GLOBAL_CONFIG.relativeDate.post&&T(document.querySelectorAll("#post-meta time"))):(GLOBAL_CONFIG.relativeDate.homepage&&T(document.querySelectorAll("#recent-posts time")),GLOBAL_CONFIG.runtime&&J(),U(),Q()),M(),GLOBAL_CONFIG_SITE.isHome&&N(),$(),GLOBAL_CONFIG.isPhotoFigcaption&&_(),H(),btf.removeGlobalFnEvent("justifiedGallery");const t=document.querySelectorAll("#article-container .gallery-container");t.length&&O(t),D(),K(),V(),Y(),X(),z()},refreshFn(),et()});
